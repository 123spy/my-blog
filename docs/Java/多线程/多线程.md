# 《Java并发编程的艺术》

### 第一阶段

无缝衔接，颠覆认知（第 2 章 + 第 4 章）

**目标**：接上你刚才学的 `synchronized`，让你立刻感觉“变强了”。

- **先读：第 4 章 (Java并发编程基础)**
  - **内容**：线程状态、Daemon线程、Interrupted、Join。
  - **策略**：**快速浏览**。因为这些你刚才在“韩顺平体系”里已经学过了，就把这章当作复习，查漏补缺。
- **精读：第 2 章 (Java并发机制的底层实现原理)**
  - **重点中的重点**：
    - **2.1 volatile 的应用**：它怎么保证可见性？（了解 Lock 前缀指令）。
    - **2.2 synchronized 的实现原理**：**这是本阶段的核心！** 必须搞懂 **对象头 (Mark Word)** 长什么样，以及 **锁升级** 的全过程（偏向锁 -> 轻量级锁 -> 重量级锁）。
    - **2.3 原子操作 (CAS)**：这是后面学 JUC 的基石。
  - **避坑**：不要死磕汇编代码，看懂流程图即可。

> **✅ 阶段成果**：你现在能回答面试题：“为什么现在 synchronized 性能变好了？”、“CAS 是什么？”。



### 第二阶段

核心攻坚，拿下 AQS（第 5 章 + 第 7 章）

**目标**：掌握 JUC 包的“心脏”——AQS。这是全书最难啃、但也最值钱的部分。

- **先读：第 7 章 (Java中的13个原子操作类)**
  - **内容**：`AtomicInteger`, `AtomicReference` 等。
  - **策略**：比较简单，结合第 2 章学的 CAS 原理，知道怎么用就行。
- **死磕：第 5 章 (Java中的锁)**
  - **核心**：**5.2 队列同步器 (AQS)**。
  - **怎么学**：
    - AQS 是个抽象类，你把它想象成一个**“排队管理器”**。
    - 搞懂那个 `int state` 变量（0表示无锁，1表示有锁）。
    - 搞懂那个 **FIFO 队列**（抢不到锁的线程是怎么被挂起的）。
  - **扩展**：看完 AQS，立刻看 **5.3 ReentrantLock**，看它是怎么利用 AQS 实现锁的。
  - **对比**：此时要对比 `ReentrantLock` 和 `synchronized` 的区别（公平性、可中断）。

> **✅ 阶段成果**：你终于明白各种花哨的锁（重入锁、读写锁、信号量）底层其实都是同一个逻辑（AQS）。



### 第三阶段

实战工具，面试必问（第 6 章 + 第 8 章）

**目标**：掌握工作中真正会用到的工具，特别是 `ConcurrentHashMap` 和 线程池。

- **精读：第 6 章 (Java并发容器和框架)**
  - **核心**：**6.1 ConcurrentHashMap**。
  - **必考点**：它在 JDK 1.7（分段锁 Segment）和 JDK 1.8（CAS + synchronized + 红黑树）的区别。这题面试出现率 100%。
  - **次要**：`BlockingQueue`（阻塞队列），它是线程池的仓库。
- **精读：第 8 章 (Java中的线程池)**
  - **核心**：`ThreadPoolExecutor` 的工作流程。
  - **策略**：别只背参数，要画出任务提交的流程图（核心线程 -> 队列 -> 最大线程 -> 拒绝）。
  - **实战**：思考一下，CPU 密集型任务和 IO 密集型任务，线程数该怎么配？

> **✅ 阶段成果**：你能手写一个线程池配置，并且能把 HashMap 为什么不安全、ConcurrentHashMap 为什么安全讲得头头是道。



### 第四阶段

返璞归真，底层原理（第 1 章 + 第 3 章）

**目标**：补全最后一块拼图，理解“计算机底层原理”。这是最枯燥的，所以放最后。

- **阅读：第 1 章 (并发编程的挑战)**
  - **内容**：上下文切换、死锁。
  - **策略**：轻松阅读，理解多线程不是“银弹”，它也有开销。
- **深究：第 3 章 (Java内存模型 JMM)**
  - **内容**：主内存与工作内存、重排序、Happens-Before、内存屏障。
  - **为什么放最后**：因为太抽象。但有了前面的铺垫，你现在明白为什么需要 `volatile` 禁止重排序了。
  - **重点**：背诵 **Happens-Before** 规则的其中几条，理解 **final** 域的内存语义（为什么单例模式要用 volatile）。



### 学习小贴士

1. **不要每一行代码都看**：书里贴了很多 JDK 源码，有时候贴得太长。你主要看**作者的中文分析**和**流程图**。
2. **多画图**：学 AQS 和 线程池时，一定要自己在纸上画状态流转图。
3. **结合视频**：如果在 **第 5 章 AQS** 卡住了（这很正常），去 B 站搜一个 AQS 的源码解析视频配合着看，书视频结合，效果最好。

按这个顺序，你不会觉得枯燥，每一步都有明确的收获。准备好开始第一阶段（第 2 章）了吗？